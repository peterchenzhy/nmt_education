<page-header [title]="pageHeader"></page-header>
<form nz-form [formGroup]="form" (ngSubmit)="_submitForm()" [nzLayout]="'vertical'">
    <nz-card [nzBordered]="false" nzTitle="学生信息">
        <nz-row nzGutter="16">
            <nz-col nzLg="6" nzMd="12" nzSm="24">
                <nz-form-item>
                    <nz-form-label nzFor="name">学生姓名</nz-form-label>
                    <nz-form-control nzErrorTip="请输入学生姓名">
                        <input nz-input formControlName="name" placeholder="请输入学生姓名" />
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzXl]="{ span: 6, offset: 2 }" [nzLg]="{ span: 8 }" [nzMd]="{ span: 12 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>性别</nz-form-label>
                    <nz-form-control nzErrorTip="请选择性别">
                        <nz-radio-group formControlName="sex">
                            <label nz-radio [nzValue]="1">男</label>
                            <label nz-radio [nzValue]="0">女</label>
                        </nz-radio-group>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzXl]="{ span: 6, offset: 2 }" [nzLg]="{ span: 8 }" [nzMd]="{ span: 12 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label nzFor="birthday">出生日期</nz-form-label>
                    <nz-form-control nzErrorTip="请输入出生日期">
                        <nz-date-picker formControlName="birthday"></nz-date-picker>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
        </nz-row>
        <nz-row nzGutter="16">
            <nz-col nzLg="6" nzMd="12" nzSm="24">
                <nz-form-item>
                    <nz-form-label nzFor="phone">联系方式</nz-form-label>
                    <nz-form-control nzErrorTip="请输入联系方式">
                        <input nz-input formControlName="phone" placeholder="请输入联系方式" />
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzXl]="{ span: 6, offset: 2 }" [nzLg]="{ span: 8 }" [nzMd]="{ span: 12 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>学校</nz-form-label>
                    <nz-form-control nzErrorTip="请输入学校">
                        <input nz-input formControlName="school" placeholder="请输入学校" />
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzXl]="{ span: 6, offset: 2 }" [nzLg]="{ span: 8 }" [nzMd]="{ span: 12 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>年级</nz-form-label>
                    <nz-form-control>
                        <nz-select formControlName="grade" [nzPlaceHolder]="'请选择年级'" [nzShowSearch]="true">
                            <nz-option *ngFor="let i of gradeList" [nzLabel]="i.label" [nzValue]="i.value"> </nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
        </nz-row>
        <nz-row nzGutter="16">
            <nz-col nzLg="6" nzMd="12" nzSm="24">
                <nz-form-item>
                    <nz-form-label>所在校区</nz-form-label>
                    <nz-form-control nzErrorTip="请选择校区">
                        <nz-select formControlName="campus" [nzPlaceHolder]="'请选择校区'" [nzShowSearch]="true">
                            <nz-option *ngFor="let i of campusList" [nzLabel]="i.label" [nzValue]="i.value">
                            </nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzXl]="{ span: 14, offset: 2 }" [nzLg]="{ span: 16 }" [nzMd]="{ span: 18 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>备注</nz-form-label>
                    <nz-form-control nzErrorTip="请输入学生备注">
                        <textarea nz-input formControlName="remark" [nzAutosize]="{ minRows: 4 }"
                            placeholder="请输入学生备注"></textarea>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
        </nz-row>
    </nz-card>
    <nz-card [nzBordered]="false" nzTitle="家长信息">
        <nz-table formArrayName="parents" [nzData]="parents.value" [nzShowPagination]="false">
            <thead>
                <tr>
                    <th>关系</th>
                    <th>姓名</th>
                    <th>联系方式</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of parents.controls; let i = index" [formGroupName]="i">
                    <td>
                        <span *ngIf="editIndex !== i">{{ parents.value[i].relation }}</span>
                        <span *ngIf="editIndex === i" nz-form-control nzErrorTip="请选择关系">
                            <nz-select formControlName="relation" [nzPlaceHolder]="'请选择关系'" [nzShowSearch]="true">
                                <nz-option *ngFor="let i of relationships" [nzLabel]="i.label" [nzValue]="i.value">
                                </nz-option>
                            </nz-select>
                        </span>
                    </td>
                    <td>
                        <span *ngIf="editIndex !== i">{{ parents.value[i].name }}</span>
                        <span *ngIf="editIndex === i" nz-form-control nzErrorTip="请输入家长姓名">
                            <input nz-input formControlName="name" />
                        </span>
                    </td>
                    <td>
                        <span *ngIf="editIndex !== i">{{ parents.value[i].phone }}</span>
                        <span *ngIf="editIndex === i" nz-form-control nzErrorTip="请输入联系方式">
                            <input formControlName="price" placeholder="请输入联系方式" />
                        </span>
                    </td>
                    <td>
                        <span *ngIf="editIndex !== i">
                            <a (click)="edit(i)">编辑</a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a nz-popconfirm nzPopconfirmTitle="是否要删除此行？" (nzOnConfirm)="del(i)">删除</a>
                        </span>
                        <span *ngIf="editIndex === i">
                            <a (click)="save(i)">保存</a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a nz-popconfirm nzPopconfirmTitle="是否要取消操作？" (nzOnConfirm)="cancel(i)">取消</a>
                        </span>
                    </td>
                </tr>
            </tbody>
        </nz-table>
        <button *ngIf="editIndex === -1" nz-button [nzType]="'dashed'" (click)="add()" nzBlock class="mt-md">
            <i nz-icon nzType="plus"></i>
            <span>新增家长</span>
        </button>
    </nz-card>
    <footer-toolbar errorCollect>
        <button nz-button type="primary" nzType="primary">提交</button>
    </footer-toolbar>
</form>
<nz-card [nzBordered]="true">
    <div class="text-lg mb-md">报名课程</div>
    <st #st [data]="courses" [columns]="coursesColumns" [page]="{ show: true }">
        <ng-template st-row="courseStatus" let-i>
            <nz-badge [nzStatus]="i.courseStatusType" [nzText]="i.courseStatusText"></nz-badge>
        </ng-template>
        <ng-template st-row="orderStatus" let-i>
            <nz-badge [nzStatus]="i.orderStatusType" [nzText]="i.orderStatusText"></nz-badge>
        </ng-template>
    </st>
</nz-card>